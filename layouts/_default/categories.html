{{ define "main" }}
<div class="universal-wrapper">
    <div class="row">
        <div class="col-lg-12">
            <h1>{{ .Title }}</h1>
            {{ with .Content }}{{ . }}{{ end }}

            <!-- 分类卡片展示 -->
            <div class="row">
                {{ range $name, $taxonomy := .Site.Taxonomies.categories }}
                {{ with $.Site.GetPage (printf "/categories/%s" $name) }}
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card category-card h-100">
                        <div class="card-body d-flex flex-column">
                            <h4 class="card-title">
                                <a href="{{ .Permalink }}" class="text-decoration-none">
                                    <i class="fas fa-folder-open mr-2"></i>{{ .Title }}
                                </a>
                            </h4>
                            <p class="text-muted mb-3">
                                <i class="fas fa-file-alt mr-1"></i>{{ len $taxonomy }} 篇文章
                            </p>

                            <!-- 显示该分类下的文章列表 -->
                            <div class="category-posts flex-grow-1">
                                {{ $pages := slice }}
                                {{ range $taxonomy }}
                                  {{ $pages = $pages | append .Page }}
                                {{ end }}
                                {{ $sortedPages := sort $pages "Date" "desc" }}
                                {{ range first 5 $sortedPages }}
                                <div class="post-item mb-2">
                                    <a href="{{ .Permalink }}" class="post-link">
                                        {{ .Title }}
                                    </a>
                                    <small class="text-muted d-block">
                                        {{ .Date.Format "2006-01-02" }}
                                    </small>
                                </div>
                                {{ end }}
                                {{ if gt (len $taxonomy) 5 }}
                                <div class="text-muted small">
                                    还有 {{ sub (len $taxonomy) 5 }} 篇文章...
                                </div>
                                {{ end }}
                            </div>

                            <div class="mt-auto pt-3">
                                <a href="{{ .Permalink }}" class="btn btn-outline-primary btn-block">
                                    查看全部文章 <i class="fas fa-arrow-right ml-1"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                {{ end }}
                {{ end }}
            </div>
        </div>
    </div>
</div>

<style>
    .category-card {
        transition: transform 0.2s, box-shadow 0.2s;
        border: 1px solid #e9ecef;
    }

    .category-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .category-card .card-title a {
        color: #495057;
    }

    .category-card .card-title a:hover {
        color: #007bff;
    }

    .post-link {
        color: #6c757d;
        text-decoration: none;
        font-size: 0.9rem;
    }

    .post-link:hover {
        color: #007bff;
        text-decoration: none;
    }

    .post-item {
        padding: 0.25rem 0;
        border-bottom: 1px solid #f8f9fa;
    }

    .post-item:last-child {
        border-bottom: none;
    }
</style>
{{ end }}